package loop2packet

import "testing"

func TestInvalidPacket(t *testing.T) {
	_, err := Decode([]byte{})

	if err == nil {
		t.Errorf("Packet should be invalid")
	}

	_, err = Decode([]byte{
		0x0, 0xff, 0x7f, 0xff, 0x7f, 0x45, 0x0, 0xff, 0x41,
		0xff, 0x56, 0x0, 0x52, 0x0, 0xff, 0x7f, 0x0, 0x0,
		0xff, 0xff, 0x7f, 0x0, 0x0, 0xff, 0xff, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, 0x0,
		0x0, 0xc8, 0xff, 0x12, 0x72, 0x12, 0x72, 0x79,
		0x74, 0xff, 0x8, 0x9, 0x7, 0xa, 0xf, 0x3, 0x15, 0x30,
	})

	if err == nil {
		t.Errorf("Packet should be invalid")
	}

	_, err = Decode([]byte{0x6, 0x4a, 0x4f, 0x4f, 0x3c, 0x1, 0xff, 0x7f, 0x54,
		0x74, 0xe6, 0x2, 0x32, 0x36, 0x3, 0x3, 0xff,
		0x36, 0x0, 0x25, 0x0, 0x1f, 0x0, 0x4, 0x0, 0x2d,
		0x0, 0xff, 0x7f, 0xff, 0x7f, 0x45, 0x0, 0xff, 0x41,
		0xff, 0x56, 0x0, 0x52, 0x0, 0xff, 0x7f, 0x0, 0x0,
		0xff, 0xff, 0x7f, 0x0, 0x0, 0xff, 0xff, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, 0x0,
		0x0, 0xc8, 0xff, 0x12, 0x72, 0x12, 0x72, 0x79,
		0x74, 0xff, 0x8, 0x9, 0x7, 0xa, 0xf, 0x3, 0x15, 0x30,
		0x5, 0x2, 0x2, 0xff, 0x7f, 0xff, 0x7f, 0xff, 0x7f,
		0xff, 0x7f, 0xff, 0x7f, 0xff, 0x7f, 0xa, 0xa, 0x8f, 0xb8})

	if err == nil {
		t.Errorf("Packet should be invalid")
	}
}

func TestValidPacket(t *testing.T) {
	_, err := Decode([]byte{0x6, 0x4c, 0x4f, 0x4f, 0x3c, 0x1, 0xff, 0x7f, 0x54,
		0x74, 0xe6, 0x2, 0x32, 0x36, 0x3, 0x3, 0xff,
		0x36, 0x0, 0x25, 0x0, 0x1f, 0x0, 0x4, 0x0, 0x2d,
		0x0, 0xff, 0x7f, 0xff, 0x7f, 0x45, 0x0, 0xff, 0x41,
		0xff, 0x56, 0x0, 0x52, 0x0, 0xff, 0x7f, 0x0, 0x0,
		0xff, 0xff, 0x7f, 0x0, 0x0, 0xff, 0xff, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, 0x0,
		0x0, 0xc8, 0xff, 0x12, 0x72, 0x12, 0x72, 0x79,
		0x74, 0xff, 0x8, 0x9, 0x7, 0xa, 0xf, 0x3, 0x15, 0x30,
		0x5, 0x2, 0x2, 0xff, 0x7f, 0xff, 0x7f, 0xff, 0x7f,
		0xff, 0x7f, 0xff, 0x7f, 0xff, 0x7f, 0xa, 0xa, 0x8f, 0xb8})

	if err != nil {
		t.Errorf("Packet should be valid")
	}

}
